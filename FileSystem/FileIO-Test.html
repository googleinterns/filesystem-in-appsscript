<!-- This is only intended to be used for testing FileIO functionality locally-->

<script src="FileIO.js"></script>
<script src="FileIOUtil.js"></script>
<script src="VbaStructures.js"></script>

<!-- 
Open "TESTFILE" For Output As #1 ' Open file for output. 
Print #1, "This is a test" ' Print text to file. 
Print #1, ' Print blank line to file. 
Print #1, "Zone 1"; Tab ; "Zone 2" ' Print in two print zones. 
Print #1, "Hello" ; " " ; "World" ' Separate strings with space. 
Print #1, Spc(5) ; "5 leading spaces " ' Print five leading spaces. 
Print #1, Tab(10) ; "Hello" ' Print word at column 10. 
 
' Assign Boolean, Date, Null and Error values. 
Dim MyBool, MyDate, MyNull, MyError 
MyBool = False : MyDate = #February 12, 1969# : MyNull = Null 
MyError = CVErr(32767) 
' True, False, Null, and Error are translated using locale settings of 
' your system. Date literals are written using standard short date 
' format. 
Print #1, MyBool ; " is a Boolean value" 
Print #1, MyDate ; " is a date" 
Print #1, MyNull ; " is a null value" 
Print #1, MyError ; " is an error value" 
Close #1 ' Close file.  -->

<script>
  /** FileIO Print Test Start */
  FileIO.openFiles[1] = {
    content: '',
    pointer: 0,
  };

  FileIO.printToFile(1, ['This is a test']);
  FileIO.printToFile(1, []);
  FileIO.printToFile(1, ['Zone 1', new Tab(), 'Zone 2']);
  FileIO.printToFile(1, ['Hello', ' ', 'World']);
  FileIO.printToFile(1, [new Space(5), '5 leading spaces ']);
  FileIO.printToFile(1, [new Tab(10), 'Hello']);
  FileIO.printToFile(1, [false, ' is a Boolean value']);
  FileIO.printToFile(1, [new VbaDate(new Date('2/12/1969')), ' is a date']);
  FileIO.printToFile(1, [null, ' is a null value']);
  FileIO.printToFile(1, [new Error(32767), ' is an error value']);

  console.log(FileIO.openFiles[1].content);
  var actualContent =
    'This is a test\r\n\r\nZone 1        Zone 2\r\nHello World\r\n     5 leading spaces \r\n         Hello\r\nFalse is a Boolean value\r\n12-02-1969  is a date\r\nNull is a null value\r\nError 32767 is an error value\r\n';
  console.log(actualContent == FileIO.openFiles[1].content);
  /** FileIO Print Test End */

  /** FileIO Line Input Test Start */
  FileIO.openFiles[1].pointer = 0;
  while (!FileIO.isEOF(1)) {
    var variable = new VbaBox('');
    FileIO.lineInputFile(1, variable);
    console.log(variable.referenceValue);
  }
  /** FileIO Line Input Test End */
</script>
<!-- 
Open "TESTFILE" For Output As #1    ' Open file for output. 
Write #1, "Hello World", 234    ' Write comma-delimited data. 
Write #1,    ' Write blank line. 
 
Dim MyBool, MyDate, MyNull, MyError 
' Assign Boolean, Date, Null, and Error values. 
MyBool = False : MyDate = #February 12, 1969# : MyNull = Null 
MyError = CVErr(32767) 
' Boolean data is written as #TRUE# or #FALSE#. Date literals are  
' written in universal date format, for example, #1994-07-13#  
 'represents July 13, 1994. Null data is written as #NULL#.  
' Error data is written as #ERROR errorcode#. 
Write #1, MyBool ; " is a Boolean value" 
Write #1, MyDate ; " is a date" 
Write #1, MyNull ; " is a null value" 
Write #1, MyError ; " is an error value" 
Close #1    ' Close file. -->

<script>
  /** FileIO Write Test Start */
  FileIO.openFiles[1] = {
    content: '',
    pointer: 0,
  };

  FileIO.writeToFile(1, ['Hello World', 234]);
  FileIO.writeToFile(1, []);
  FileIO.writeToFile(1, [false, ' is a Boolean value']);
  FileIO.writeToFile(1, [new VbaDate(new Date('2/12/1969')), ' is a date']);
  FileIO.writeToFile(1, [null, ' is a null value']);
  FileIO.writeToFile(1, [new Error(32767), ' is an error value']);

  console.log(FileIO.openFiles[1].content);
  var actualContent =
    '"Hello World",234\r\n\r\n#FALSE#," is a Boolean value"\r\n#1969-02-12#," is a date"\r\n#NULL#," is a null value"\r\n#ERROR 32767#," is an error value"\r\n';
  console.log(actualContent == FileIO.openFiles[1].content);

  /** FileIO Write Test End */

  /** FileIO Input Test Start */
  FileIO.openFiles[1].pointer = 0;
  var count = 0;
  
  while (!FileIO.isEOF(1)) {
    var variable = new VbaBox('');
    FileIO.inputFile(1, [variable]);
    console.log(variable.referenceValue);
    count++;
  }
  console.log(count);
  /** FileIO Input Test End */
</script>
